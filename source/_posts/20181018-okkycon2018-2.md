---
title: 20181018-okkycon2018-2
tags:
  - okkycon2018
  - tdd
categories:
  - conference
date: 2018-10-18 10:39:49
updated:  2018-10-18 10:39:49
---

# 의식적인 연습으로 TDD, 리팩토링 연습하기

- okkycon2018에 참석했다.
- 정말 좋은 얘기들이 많았다.
- 이 느낌을 오래동안 간직하고 싶어서 오랫만에 글을 남긴다.
- 자주 보면서 꾸준히 연습해보자.
- 나머지 발표들도 시간나는 대로 정리할 예정이다.

## 감상

- 자바지기로 유명하신 박재성님의 발표
- TDD, 리팩토링, 테스트 등의 가이드를 정말 쉽게 설명해주셨다.
- 꾸준히 연습해보고 싶은 마음이 생긴다.

## 요약

- 현재 교육사업 중: 넥스트스탭
- 교육과정 중에 TDD가 있음

- 전제
  - TDD와 리펙토링을 왜 해야 하는지 알고 있다.
  - TDD와 리펙토링을 비슷한 비중으로 다룬다.

- 발표 내용
  - 의식적인 연습이란?
  - 의식적인 연습을 통해서 효과적으로 TDD, 리팩토링을 연습하자.

- 의식적인 연습이란?
  - 연습을 많이 하면 실력이 높아질거라 생각한다.
  - TDD, 리팩토링을 잘 하려면 연습, 연습, 연습...
  - 무조건 연습을 많이 한다고 잘할 수 있을까?
  - 10년차 프로그래머가 1년차 프로그래머보다 낫다고 할 수 있는가?
  - 테스트하기 쉬운 코드와 테스트하기 여려운 코드를 보는 눈
  - 테스트하기 어려운 코드를 테스트하기 쉬운 코드로 설계하는 감(sense)
  - 5 6 년을 연습한 후에야 생겼다.
  - 책: 1만 시간의 재발견
  - 아마추어와 프로의 결정적 차이
    - 목적 있는 연습에 얼마나 많은 시간을 투자했는가

- 의식적인 연습의 7가지 원칙
  - 컴포트 존을 깨는 연습을 해야 한다.
  - 구체적이고 명확한 목표를 가지고 연습을 해야 한다.
  - 즉각적인 피드백을 받을 수 있도록
  - 한가지씩 개선하기 위한 연습을 하자.

- 이런식의 연습을 설계해서 연습하는 것이 어려웠다.
  - 코치
    - 연습방법을 설계하고 피드백을 줄 수 있어야 한다.

- 의식적인 연습으로 TDD, 리팩토링
  - 1단계 - 단위 테스트 연습
  - 2단계 - TDD 연습하기
  - 3단계 - 리팩토링 연습
  - 4단계 - 장난감 프로젝트 난이도 높이기
  - 5단계 - 의존관계 추가를 통한 난이도 높이기

- 1단계: 단위 테스트 연습
  - TDD보다 단위 테스트 먼저
  - 자기가 사용하는 API 사용법을 익히기 위한 학습 테스트에서 시작
    - 자바 String 클래스의 다양한 메소드
      - ex: split 테스트 메소드
    - Array 클래스의 다양한 메소드
  - 연습 효과
    - 단위 테스트 방법을 학습할 수 있다.
    - 단위 테스트에 대한 친숙함이 생긴다.
  - 내가 구현하는 메소드 중 input과 output이 명확한 클래스 메소드(보통 util 성격의 메소드)에 대한 단위 테스트
  - 프로덕션 코드를 먼저 만들고 단위 테스트 코드를 만들어봐도 상관없다.
  - 알고리즘을 학습한다면 알고리즘 구현에 대한 검증을 단위 테스트로 한다.
  - 알고리즘은 input, output이 명확하기 때문에 연습하기 좋다.

- 2단계: TDD 연습하기
  - 회사 프로젝트에 연습하지 말고 장난감 프로젝트를 활용해 연습하자.
  - 회사 프로젝트로 TDD를 연습하기에는 시간이 부족하다.
  - 회사 프로젝트는 대부분 거대하다.
  - 테스트 하기 쉬운 코드와 그렇지 않은 코드를 분리하기 힘들다.
  - 웹, 모바일 UI, DB 등은 생각하지 말자.
  - 장난감 프로젝트로 연습해야 압박감이 없다.
  - 압박감이 없고 여유가 있어야 창의적이 된다.

- 장난감 프로젝트: 문자열 덧셈 계산기
  - 명확한 요구사항을 만들고 TDD를 시작하자.
  - 어려운 문제를 해결하는 것이 목적이 아니라 TDD 연습이 목적

- TDD cycle
  - test fail -> test pass -> refactor -> test fail ...
  - refactoring은 힘들 수 있다.
  - test pass 까지만 실행해도 좋다.
  - 테스트 코드를 먼저 만드는 연습을 많이하자.

- 3단계: 리팩토링 연습
  - 메소드 분리
    - input, output 변경은 없다.
  - 정량적인 원칙
    - 처음에는 막막할 수 있다. 정량적인 원칙을 고려하자.
    - 한 메서드에 오직 한 단계의 들어쓰기만 한다.
      - 한 단계 들여쓰기 이상의 코드는 함수로 분리한다.
    - else를 쓰지 않는다.
      - 코드도 짧아지고 가독성이 좋아진다.
      - 자동으로 들여쓰기가 줄어든다.
  - 정성적인 원칙
    - 메소드가 한 가지 일만 하도록 구현하기
      - 정말 한가지 일만 하고 있는가? 다시 한번 살펴보자.
    - 로컬 변수가 정말 필요한가?
      - 로컬 변수가 반드시 필요하지 않는다면 메소드 체인 등으로 처리
    - 메소드들이 동등한 수준인가?
    - 연습할 때는 극단적으로 과하게 해야 인사이트가 생긴다.
  - 클래스 분리
    - 모든 원시값과 문자열을 포장한다. -> 클래스로 만든다.
    - 일급 콜렉션을 쓴다.
    - 3개 이상의 인스턴스 변수를 가진 클래스를 쓰지 않는다.
      - 어려우면 인스턴스 변수를 한 개씩 줄여보자.
      - 객체 설계 연습을 많이 하게 된다.
  - 한 번에 모든 원칙을 지키면서 리팩토링하려고 연습하지 마라.
  - 한 번에 한 가지 명확하고 구체적인 목표를 가지고 연습하라.
  - 연습은 극단적인 방법으로 연습하는 것도 좋다.
    - 예를 들어 한 메소드의 라인 수 제한을 15라인 -> 10라인으로 줄여가면서 연습해보자.
    - 테스트가 뒷받침되어야 한다.

- 4단계: 장난감 프로젝트 난이도 높이기
  - 점진적으로 요구사항이 복잡한 프로그램을 구현한다.

- 5단계: 의존관계 추가를 통한 난이도 높이기
  - 웹, 모바일 UI, DB 같은 의존관계 추가

- 한 단계 더 나아간 연습을 하고 싶다면
  - 컴파일 에러를 최소화하면서 리팩토링하기
  - ATDD 기반으로 응용 애플리케이션 개발하기
  - 레거시 애플리케이션에 테스트 코드 추가해 리팩토링하기

- 구체적인 연습 목표 찾기
  - 책: 소트웍스 앤솔러지-소프트웨어 기술과 혁신에 관한 에세이
  - 책: 클린코드
  - 책에 있는 원칙들을 지키면서 코드를 만들어보자.

- TDD, 리팩토링 연습을 위해 필요한 것은?
  - 조급함 대신 마음의 여유
  - 나만의 장난감 프로젝트
  - 같은 과제를 반복적으로 구현할 수 있는 인내력

- 가장 필요한 것은 가보지 않은 길에 꾸준히 도전할 수 있는 용기

## 질문

- 컴포트 존을 극복하는 노하우
  - 경력이 쌓일 수록 나이를 먹을 수록 힘들 것 같다.
  - 삶의 여유와 에너지가 필요하다.
  - 컴포트 존을 벗어나는 것은 상당히 스트레스 받는 일이다.
  - 1~2년 간 친구 관계도 줄이고 애인도 덜 만나고 시간 확보를 해서 고통스러울 정도로 연습을 해야한다.

- 테스트 코드가 발목을 잡을떄?
  - 테스트 코드가 잘 동작하고 있었을 때 요구사항이 변경되면 테스트 코드가 다 망가지고 다시 만들어야 한다.
  - 왜 그럴까?
  - 요구사항이 변경되었을 때 왜 수정할 것이 많을까?
  - 요구사항이 변경된 것이 문제가 아니라 설계를 잘못한 것
  - 꼭 설계부터 다시 검토해봐야 한다.
  - 나중에는 시간이 나지 않는다. 그 시점에서 꼭 다시 검토해야 한다.
